<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <title>äº¤ä¸ªæœ‹å‹ Â· AI ç¤¾äº¤æ™ºèƒ½ä½“ Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      width: 100%;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
      background: radial-gradient(circle at 20% 0%, #1b2340 0%, #0a0d1f 45%, #050615 100%);
      color: #fff;
      overflow-x: hidden;
    }

    /* å¡ç‰‡å…‰æ™• */
    .card {
      background: rgba(10, 16, 40, .82);
      border-radius: 18px;
      border: 1px solid rgba(120, 150, 255, .18);
      box-shadow: 0 14px 32px rgba(0, 0, 0, .45);
      backdrop-filter: blur(18px);
    }

    /* é¡¶éƒ¨å¯¼èˆª */
    .top-nav {
      padding: 20px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .top-logo {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 2px solid #19e0d8;
      display: flex;
      align-items: center;
      justify-content: center;
      background:
        radial-gradient(circle at 10% 0%, rgba(150, 150, 150, .35) 0, transparent 35%),
        radial-gradient(circle at 60% 80%, rgba(60, 60, 60, .5) 0, transparent 55%),
        radial-gradient(circle at 50% 50%, #11151b 0, #05070b 65%, #000 100%);
      font-weight: 800;
      font-size: 17px;
    }

    .top-logo .l {
      color: #19e0d8;
    }

    .nav-btn {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, .2);
      background: rgba(20, 30, 60, .6);
      font-size: 12px;
      cursor: pointer;
      color: #fff;
    }

    .nav-btn:hover {
      background: rgba(45, 70, 130, .9);
    }

    /* ä»‹ç»åŒº */
    .hero {
      padding: 40px 32px 10px 32px;
      max-width: 1000px;
      margin: auto;
    }

    .title {
      font-size: 32px;
      font-weight: 800;
      line-height: 1.5;
      margin-bottom: 14px;
    }

    .title .accent {
      color: #a88bff;
    }

    .subtitle {
      opacity: .9;
      font-size: 15px;
      line-height: 1.8;
      max-width: 720px;
    }

    /* å†…å®¹æ¨¡å— */
    .sections {
      padding: 20px 32px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      max-width: 1100px;
      margin: auto;
    }

    .section {
      padding: 24px;
      border-radius: 18px;
      background: rgba(10, 16, 40, .82);
      border: 1px solid rgba(120, 150, 255, .22);
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .section p {
      opacity: .85;
      line-height: 1.8;
      font-size: 14px;
    }

    /* ä¸»èŠå¤©å¸ƒå±€ */
    .chat-layout {
      max-width: 1200px;
      margin: 40px auto;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1.6fr);
      gap: 28px;
      padding: 0 32px;
    }

    /* èŠå¤©çª—å£ */
    .chat-card {
      height: 520px;
      display: flex;
      flex-direction: column;
    }

    .chat-header {
      padding: 12px 16px;
      border-bottom: 1px solid rgba(120, 150, 255, .2);
      font-size: 13px;
      opacity: .85;
    }

    #chatHistory {
      flex: 1;
      overflow-y: auto;
      padding: 14px;
      scroll-behavior: smooth;
    }

    .bubble {
      padding: 10px 14px;
      border-radius: 14px;
      max-width: 80%;
      margin-bottom: 12px;
      line-height: 1.6;
      font-size: 14px;
      word-break: break-word;
    }

    .bubble.user {
      margin-left: auto;
      background: linear-gradient(135deg, #6db5ff, #d17bff);
    }

    .bubble.ai {
      margin-right: auto;
      background: rgba(15, 22, 60, .96);
      border: 1px solid rgba(140, 160, 255, .35);
    }

    /* è¾“å…¥åŒº */
    .chat-input-bar {
      padding: 12px;
      border-top: 1px solid rgba(120, 150, 255, .25);
      display: flex;
      align-items: flex-end;
      gap: 10px;
    
      /* å…³é”®ï¼è®©å†…éƒ¨ absolute å…ƒç´ ç›¸å¯¹è¿™é‡Œå®šä½ */
      position: relative;
    }


    #chatInput {
      flex: 1;
      min-height: 44px;
      max-height: 100px;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(150, 160, 255, .35);
      background: rgba(5, 8, 25, .9);
      color: #fff;
      resize: none;
      font-size: 14px;
      outline: none;
    }

    /* å‘é€æŒ‰é’® */
    .send-btn {
      padding: 9px 18px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #8fd3ff, #e58bff);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      color: #050615;
    }

    /* æ¸…ç©º */
    .clear-btn {
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 10px;
      background: rgba(80, 90, 150, .55);
      border: 1px solid rgba(150, 160, 255, .25);
      cursor: pointer;
      color: #ddd;
    }

    /* è¡¨æƒ… */
    #emojiBtn {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: rgba(180, 100, 255, .85);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 22px;
    }

    #emojiPicker {
      position: absolute;
      bottom: 60px;   /* åœ¨è¾“å…¥æ¡†ä¸Šæ–¹ */
      left: 0;        /* ä»å·¦å¼€å§‹å¯¹é½ */
      transform: translateX(0);
      
      background: #0f132d;
      border: 1px solid rgba(150, 150, 255, .3);
      padding: 10px;
      border-radius: 12px;
      display: none;
      flex-wrap: wrap;
      gap: 6px;
      width: 240px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 999; /* é¿å…è¢«é®æŒ¡ */
    }


    #emojiPicker span {
      font-size: 20px;
      cursor: pointer;
      transition: .15s;
    }

    #emojiPicker span:hover {
      transform: scale(1.25);
    }

    /* æƒ…ç»ªé¢æ¿ */
    .side-panel {
      padding: 20px;
      border-radius: 18px;
      border: 1px solid rgba(150, 160, 255, .25);
      background: rgba(10, 16, 40, .85);
      display: flex;
      flex-direction: column;
      gap: 16px;
      height: 520px;
    }

    .side-title {
      font-size: 15px;
      font-weight: 700;
    }

    .mood-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #9cf;
      box-shadow: 0 0 14px currentColor;
      animation: breathe 2.4s infinite ease-in-out;
    }

    @keyframes breathe {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.35);
      }

      100% {
        transform: scale(1);
      }
    }

    .badge {
      display:inline-block;
      padding:5px 10px;
      background:rgba(30,40,80,.9);
      border:1px solid rgba(140,160,255,.4);
      border-radius:999px;
      font-size:12px;
    
      /* è¿™è¡Œå°±æ˜¯å…³é”®ï¼è®¾ç½®æ–‡å­—ä¸ºç™½è‰² */
      color:#fff !important;
    
      margin-right:6px;
      margin-bottom:6px;
      cursor:pointer;
    }

  </style>
</head>

<body>

  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <div class="top-nav">
    <div class="nav-left">
      <div class="top-logo">Sou<span class="l">l</span></div>
      <div>äº¤ä¸ªæœ‹å‹ Â· AI ç¤¾äº¤æ™ºèƒ½ä½“</div>
    </div>
    <button class="nav-btn" onclick="location.href='index.html'">è¿”å›ç²’å­é¦–é¡µ</button>
  </div>

  <!-- ä»‹ç»å†…å®¹ -->
  <div class="hero">
    <div class="title">å¸®ä½ å…ˆ <span class="accent">â€œè¯»æ‡‚èŠå¤©â€</span>ï¼Œå†æ•™ä½ æ€ä¹ˆäº¤ä¸ªæœ‹å‹</div>
    <p class="subtitle">
      ã€Œäº¤ä¸ªæœ‹å‹ã€æ˜¯ä¸€ä½æ‡‚æƒ…ç»ªã€æ‡‚è¯­å¢ƒçš„ AI ç¤¾äº¤æ•™ç»ƒã€‚
      å®ƒä¼šåˆ†æä½ å’Œå¯¹æ–¹çš„èŠå¤©å†…å®¹ã€è¯­æ°”ã€æ°›å›´ï¼Œå¹¶ç»™å‡ºè‡ªç„¶ã€å¾—ä½“ã€ä¸å°´å°¬çš„æ²Ÿé€šå»ºè®®ã€‚
    </p>
  </div>

  <div class="sections">

    <div class="section">
      <div class="section-title">ğŸ”® ç²’å­ Soul åŠ¨æ•ˆï¼šçµé­‚èšæ•£çš„è§†è§‰éšå–»</div>
      <p>
        ç”¨æˆ·è¿›å…¥ä½“éªŒç«™æ—¶çœ‹åˆ°çš„ï¼Œæ˜¯ç”±ä¸Šä¸‡é¢—ç²’å­åœ¨ç©ºé—´ä¸­é€æ­¥èšåˆæˆçš„ã€ŒSoulã€Logoã€‚
        æ•´ä¸ªåŠ¨æ•ˆè±¡å¾ä¸€ç§ã€Œé è¿‘â€”åˆ†å¼€â€”å†é è¿‘ã€çš„ç¤¾äº¤èŠ‚å¥ã€‚
        <br><br>
        âœ‹ å½“ç”¨æˆ·å¼ å¼€æ‰‹æŒæ—¶ï¼š  
        ç²’å­ä¼šä» Logo ä¸­çˆ†å¼€ï¼ŒåŒ–æˆæ»¡å±æ˜Ÿäº‘ã€‚ä¸åŒæ˜Ÿå±‚ä¼šæœ‰è½»å¾®æ¼‚ç§»ï¼Œè¥é€ ç©ºé—´æ„Ÿã€‚
        <br><br>
        âœŠ å½“ç”¨æˆ·æ¡æ‹³æ—¶ï¼š  
        ç²’å­ä¼šç¼“æ…¢åœ°ä»æ˜Ÿç©ºå›è½ï¼Œé‡æ–°èšæˆ Soul å“ç‰Œå½¢çŠ¶ï¼Œå¹¶å½¢æˆè½»å¾®çš„å‘¼å¸å¼è·³åŠ¨ã€‚
        <br><br>
        æ‰‹åŠ¿è¯†åˆ«åŸºäº MediaPipe Hands å®ç°ï¼Œç²’å­è®¡ç®—ä½¿ç”¨ Canvas é€ç²’æ’å€¼ï¼Œç¡®ä¿æµç•…åº¦å’Œè´¨æ„Ÿã€‚
        è¿™æ˜¯å¯¹ã€Œçµé­‚è½åœ°ã€ã€Œäººä¸äººé è¿‘ã€çš„è§†è§‰è¡¨è¾¾ï¼Œä¹Ÿæ˜¯æ•´ä¸ªäº¤äº’ä½“éªŒçš„ç¬¬ä¸€å°è±¡ã€‚
      </p>
    </div>


    <div class="section">
      <div class="section-title">ğŸ§  äº¤ä¸ªæœ‹å‹ Â· AI ç¤¾äº¤æ™ºèƒ½ä½“æ€ä¹ˆç”¨ï¼Ÿ</div>
      <p>
        è¿™ä¸ª AI çš„è®¾è®¡ç›®æ ‡ï¼Œæ˜¯å¸®ç”¨æˆ·åœ¨çœŸå®èŠå¤©ä¸­è§£å†³ã€Œä¸çŸ¥é“è¯´ä»€ä¹ˆã€çš„å›°å¢ƒã€‚
        æ“ä½œæ–¹å¼éå¸¸ç®€å•ï¼š
        <br><br>
    
        1ï¸âƒ£ <b>åœ¨è¾“å…¥æ¡†å†™ä¸‹ä½ çš„èŠå¤©åœºæ™¯</b> â€”â€”  
        ä¾‹å¦‚ï¼šã€Œæ˜¨æ™šå¥¹çªç„¶å˜å†·æ·¡ï¼Œæˆ‘è¦ç»§ç»­èŠå—ï¼Ÿã€  
        AI ä¼šè‡ªåŠ¨åˆ†æä½ çš„æƒ…ç»ªã€è¯­æ°”ã€ä¸Šä¸‹æ–‡ï¼Œè¯†åˆ«æ˜¯å¦æ˜¯å†·åœºã€é™æ¸©ã€å°´å°¬ã€è¯•æ¢ç­‰çŠ¶æ€ã€‚
    
        <br><br>
    
        2ï¸âƒ£ <b>ç‚¹å‡»ã€ç”Ÿæˆã€</b> â€”â€”  
        AI ä¼šè¿”å›ï¼š  
        Â· ä½ çš„å½“å‰æƒ…ç»ªåˆ¤æ–­  
        Â· å¯¹è¯æ°›å›´ & å¯¹æ–¹å¯èƒ½çš„å¿ƒç†  
        Â· ä¸ªæ€§åŒ–æ²Ÿé€šå»ºè®®ï¼ˆä¸¤åˆ°ä¸‰ç§ï¼‰  
        Â· å¯ä»¥è‡ªç„¶å»¶ä¼¸çš„è¯é¢˜  
    
        <br><br>
    
        3ï¸âƒ£ <b>å¤åˆ¶ä½ å–œæ¬¢çš„å›å¤æ–¹å¼</b> â€”â€”  
        æ‰€æœ‰æ¨èè¯­å¥éƒ½ã€Œå¾—ä½“ã€ä¸æ²¹ã€ä¸å°´å°¬ã€ï¼Œ  
        å¯ä»¥ç›´æ¥ç”¨åœ¨ Soul çš„æ—¥å¸¸èŠå¤©é‡Œã€‚
    
        <br><br>
    
        æ•´ä¸ªç³»ç»Ÿé€šè¿‡ DeepSeek API + å‰ç«¯ç»“æ„åŒ–è§£æå®ç°ï¼Œè®©æ¯ä¸€å¥å›å¤éƒ½æ˜¯ AI çœŸæ­£â€œæ€è€ƒâ€åç»™å‡ºçš„ã€‚
      </p>
    </div>

    <div class="section">
      <div class="section-title">ğŸš€ ä½œå“äº®ç‚¹</div>
      <p>
        âœ” <b>æ‰‹åŠ¿äº¤äº’ + ç²’å­èšæ•£</b> â€”â€” ç”¨èº«ä½“åŠ¨ä½œæ¥æ§åˆ¶å“ç‰Œ Logoï¼Œå¢å¼ºä½“éªŒæ²‰æµ¸æ„Ÿã€‚<br>
        âœ” <b>3D ç²’å­ç©ºé—´</b> â€”â€” å…·æœ‰å±‚çº§ã€æ¼‚ç§»ã€å‘¼å¸æ„Ÿï¼Œä½¿ Logoâ€œæ´»èµ·æ¥â€ã€‚<br>
        âœ” <b>ç»“æ„åŒ–ç¤¾äº¤å»ºè®®</b> â€”â€” å›å¤ã€æ´å¯Ÿã€æƒ…ç»ªã€è¯é¢˜å…¨éƒ¨ç”± AI è‡ªåŠ¨ç”Ÿæˆã€‚<br>
        âœ” <b>å®æ—¶æƒ…ç»ªæ³¢åŠ¨ UI</b> â€”â€” å³ä¾§æƒ…ç»ªç‚¹ä¼šæ ¹æ® AI åˆ¤æ–­è‡ªåŠ¨å˜è‰²ã€‚<br>
        âœ” <b>çœŸå®èŠå¤©æ¨¡æ‹Ÿä½“éªŒ</b> â€”â€” æ”¯æŒè¡¨æƒ…ã€ç¤ºä¾‹ç‚¹å‡»ã€æ¸…ç©ºå¯¹è¯ï¼Œå®Œæ•´æµç¨‹åŒ–ä½“éªŒã€‚<br>
        âœ” <b>å‚èµ›æ–¹å‘è´´åˆåº¦é«˜</b> â€”â€” å®Œå…¨ç¬¦åˆã€Œäº¤ä¸ªæœ‹å‹ã€ç¤¾äº¤æ™ºèƒ½ä½“ä¸»é¢˜ã€‚<br>
      </p>
    </div>

  </div>


  <!-- èŠå¤©åŒº -->
  <div class="chat-layout">

    <!-- å·¦ä¾§èŠå¤© -->
    <div class="card chat-card">

      <div class="chat-header">AI ç¤¾äº¤æ•™ç»ƒ Â· Demo â€”â€” åœ¨è¿™é‡Œè¾“å…¥ä½ çš„çœŸå®èŠå¤©å›°æƒ‘ / æƒ³è¯´çš„è¯</div>

      <div id="chatHistory"></div>

      <!-- è¾“å…¥åŒº -->
      <div class="chat-input-bar">
        <div id="emojiBtn">ğŸ˜Š</div>
        <textarea id="chatInput" placeholder="è¾“å…¥ä½ çš„èŠå¤©å›°æƒ‘ï¼Œä¾‹å¦‚ï¼šå¥¹çªç„¶ä¸‰å°æ—¶ä¸å›æˆ‘ï¼Œæˆ‘è¦ç»§ç»­ç­‰å—ï¼Ÿ"></textarea>
        <button id="sendBtn" class="send-btn">ç”Ÿæˆ</button>
        <button id="clearBtn" class="clear-btn">æ¸…ç©ºå¯¹è¯</button>
      </div>

      <div id="thinkingHint" style="font-size:12px;color:rgba(255,255,255,.65);margin:6px 12px;display:none;">
        AI æ­£åœ¨åˆ†æä½ çš„èŠå¤©è¯­å¢ƒ...
      </div>

      <!-- ç¤ºä¾‹ -->
      <div style="padding:10px 12px;margin-top:4px;display:flex;gap:10px;flex-wrap:wrap;">
        <button class="badge" onclick="fillExample('æœ€è¿‘èŠå¤©æ€»æ˜¯å†·åœºæ€ä¹ˆåŠï¼Ÿ')">æœ€è¿‘èŠå¤©æ€»æ˜¯å†·åœºæ€ä¹ˆåŠï¼Ÿ</button>
        <button class="badge" onclick="fillExample('å¥¹çªç„¶å˜å¾—å†·æ·¡ï¼Œæ˜¯ä¸æ˜¯ä¸æƒ³èŠäº†ï¼Ÿ')">å¥¹çªç„¶å˜å¾—å†·æ·¡ï¼Œæ˜¯ä¸æ˜¯ä¸æƒ³èŠäº†ï¼Ÿ</button>
        <button class="badge" onclick="fillExample('æƒ³æŠŠèŠå¤©å˜å¾—è½»æ¾ä¸€ç‚¹ä½†ä¸æ²¹è…»ï¼Œæœ‰ä»€ä¹ˆè‡ªç„¶çš„è¯é¢˜ï¼Ÿ')">æƒ³æŠŠèŠå¤©å˜å¾—è½»æ¾ä¸€ç‚¹ä½†ä¸æ²¹è…»ï¼Ÿ</button>
      </div>

    </div>

    <!-- å³ä¾§æƒ…ç»ª&å»ºè®® -->
    <div class="card side-panel">

      <div>
        <div class="side-title">æœ¬è½®æƒ…ç»ª Â· æƒ…æ„Ÿæ¸©åº¦</div>
        <div style="display:flex;align-items:center;gap:10px;">
          <div class="mood-dot" id="moodDot"></div>
          <div id="moodText">ç­‰å¾…è¾“å…¥â€¦</div>
        </div>
      </div>

      <div>
        <div class="side-title">èŠå¤©æ´å¯Ÿ</div>
        <div id="insightsList" style="font-size:13px;line-height:1.6;opacity:.9;">
          è¾“å…¥èŠå¤©å†…å®¹åï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºåˆ†æç»“æœã€‚
        </div>
      </div>

      <div>
        <div class="side-title">æ²Ÿé€šå»ºè®®</div>
        <div id="suggestList" style="font-size:13px;line-height:1.6;"></div>
      </div>

      <div>
        <div class="side-title">å»¶ä¼¸è¯é¢˜</div>
        <div id="topicBadges"></div>
      </div>

    </div>
  </div>


  <!-- è¡¨æƒ…é€‰æ‹©å™¨ -->
  <div id="emojiPicker">
    <span>ğŸ˜‚</span><span>ğŸ¤£</span><span>ğŸ˜Š</span><span>ğŸ˜Œ</span><span>ğŸ˜</span>
    <span>ğŸ˜‰</span><span>ğŸ˜</span><span>ğŸ˜³</span><span>ğŸ˜®</span><span>ğŸ˜¡</span>
    <span>ğŸ˜­</span><span>ğŸ¤”</span><span>ğŸ‘</span><span>ğŸ‘</span><span>ğŸ‘</span>
    <span>ğŸ™</span><span>âœ¨</span><span>â¤ï¸</span><span>ğŸ’œ</span><span>ğŸŒ™</span>
  </div>


  <!-- JS é€»è¾‘ -->
  <script>
    const chatHistoryEl = document.getElementById("chatHistory");
    const chatInput = document.getElementById("chatInput");
    const sendBtn = document.getElementById("sendBtn");
    const clearBtn = document.getElementById("clearBtn");

    const moodText = document.getElementById("moodText");
    const moodDot = document.getElementById("moodDot");
    const insightsList = document.getElementById("insightsList");
    const suggestList = document.getElementById("suggestList");
    const topicBadges = document.getElementById("topicBadges");

    const thinkingHint = document.getElementById("thinkingHint");


    /* æ·»åŠ å¯¹è¯æ°”æ³¡ */
    function addBubble(text, type) {
      const div = document.createElement("div");
      div.className = "bubble " + type;
      div.textContent = text;
      chatHistoryEl.appendChild(div);
      chatHistoryEl.scrollTop = chatHistoryEl.scrollHeight;
    }


    /* å¡«å……ç¤ºä¾‹ */
    function fillExample(t) {
      chatInput.value = t;
      chatInput.focus();
    }


    /* Loading çŠ¶æ€ */
    function setLoading(isLoading) {
      if (isLoading) {
        sendBtn.disabled = true;
        sendBtn.style.opacity = "0.55";
        thinkingHint.style.display = "block";
      } else {
        sendBtn.disabled = false;
        sendBtn.style.opacity = "1";
        thinkingHint.style.display = "none";
      }
    }


    /* è°ƒç”¨åç«¯ DeepSeek Agent */
    async function callSocialAgent(userText) {
      const res = await fetch("/api/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          messages: [
            { role: "user", content: userText }
          ]
        })
      });

      const data = await res.json();
      let raw = data.reply || "";

      try {
        return JSON.parse(raw);
      } catch {
        return {
          reply: raw,
          mood: "æœªè¯†åˆ«",
          insights: "æ¨¡å‹æœªæŒ‰ JSON è¿”å›ã€‚",
          suggestions: [],
          topics: []
        };
      }
    }


    /* å‘é€æŒ‰é’® */
    async function handleSend() {
      const text = chatInput.value.trim();
      if (!text) return;

      addBubble(text, "user");
      chatInput.value = "";

      setLoading(true);

      try {
        const data = await callSocialAgent(text);
        addBubble(data.reply || "ï¼ˆæ²¡æœ‰ç”Ÿæˆå»ºè®®ï¼‰", "ai");
        updateSidePanel(data);
      } catch (e) {
        addBubble("AI å‡ºç°å°çŠ¶å†µï¼Œè¯·ç¨åå†è¯•ï½", "ai");
      } finally {
        setLoading(false);
      }
    }


    /* æ›´æ–°å³ä¾§æ´å¯Ÿ */
    function updateSidePanel(d) {
      moodText.textContent = d.mood || "æœªçŸ¥";

      insightsList.textContent = d.insights || "æ— åˆ†æ";

      suggestList.innerHTML = "";
      (d.suggestions || []).forEach(s => {
        const item = document.createElement("div");
        item.textContent = "Â· " + s;
        suggestList.appendChild(item);
      });

      topicBadges.innerHTML = "";
      (d.topics || []).forEach(t => {
        const b = document.createElement("div");
        b.className = "badge";
        b.textContent = t;
        topicBadges.appendChild(b);
      });
    }


    sendBtn.onclick = handleSend;

    chatInput.addEventListener("keydown", e => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        handleSend();
      }
    });


    /* æ¸…ç©ºå¯¹è¯ */
    clearBtn.onclick = () => {
      chatHistoryEl.innerHTML = "";
      moodText.textContent = "ç­‰å¾…è¾“å…¥â€¦";
      insightsList.textContent = "è¾“å…¥èŠå¤©å†…å®¹åï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºåˆ†æç»“æœã€‚";
      suggestList.innerHTML = "";
      topicBadges.innerHTML = "";
      addBubble("å¯¹è¯å·²æ¸…ç©ºï¼Œä½ å¯ä»¥å‘Šè¯‰æˆ‘æ–°çš„èŠå¤©å›°æƒ‘ ğŸ˜„", "ai");
    };


    /* è¡¨æƒ…é¢æ¿ */
    const emojiBtn = document.getElementById("emojiBtn");
    const emojiPicker = document.getElementById("emojiPicker");

    emojiBtn.onclick = () => {
      emojiPicker.style.display =
        emojiPicker.style.display === "none" ? "flex" : "none";
    };

    emojiPicker.querySelectorAll("span").forEach(e => {
      e.onclick = () => {
        chatInput.value += e.textContent;
        emojiPicker.style.display = "none";
      };
    });

  </script>

</body>

</html>

